[2025-08-05 00:51:33] INFO     | Logging initialized. Log file: logs/batch_run_20250805_005133.log
[2025-08-05 00:51:33] INFO     | ============================================================
[2025-08-05 00:51:33] INFO     | BATCH PROCESSING STARTED
[2025-08-05 00:51:33] INFO     | Start time: 2025-08-05 00:51:33
[2025-08-05 00:51:33] INFO     | ============================================================
[2025-08-05 00:51:33] INFO     | Phase 1: Discovery
[2025-08-05 00:51:33] INFO     |   ├── Found 10 simulation files in ../../step1/data
[2025-08-05 00:51:33] INFO     |   ├── Rate 0.001000: simulation_rate_0.001000_m10000_n1000_t100.json.gz
[2025-08-05 00:51:33] INFO     |   ├── Rate 0.003000: simulation_rate_0.003000_m10000_n1000_t100.json.gz
[2025-08-05 00:51:33] INFO     |   ├── Rate 0.005000: simulation_rate_0.005000_m10000_n1000_t100.json.gz
[2025-08-05 00:51:33] INFO     | Selected 3 simulations to process
[2025-08-05 00:51:33] INFO     | 
Phase 2: Validation
[2025-08-05 00:51:33] INFO     |   ├── Disk space: 24.9 GB available
[2025-08-05 00:51:33] INFO     |   ├── Script found: extract_snapshot.py
[2025-08-05 00:51:33] INFO     |   ├── Script found: create_lineages.py
[2025-08-05 00:51:33] INFO     |   ├── Script found: plot_jsd_distribution.py
[2025-08-05 00:51:33] INFO     |   ├── Python version: Python 3.9.7
[2025-08-05 00:51:33] INFO     | 
Phase 3: Processing
[2025-08-05 00:51:33] INFO     | 
Processing rate 0.001000 (1/3)
[2025-08-05 00:53:44] INFO     |   ├── Extracted snapshot OK (131.9s)
[2025-08-05 00:53:45] ERROR    | Creating both lineages failed: usage: create_lineages.py [-h] [-t {mutant,control,both}]
                          [-c CELLS_PER_DECILE] [-n N_CONTROL] [-y YEARS]
                          [-o OUTPUT_DIR] [--seed SEED]
                          snapshot_file
create_lineages.py: error: the following arguments are required: snapshot_file

[2025-08-05 00:53:45] ERROR    |   ├── Failed to create lineages: usage: create_lineages.py [-h] [-t {mutant,control,both}]
                          [-c CELLS_PER_DECILE] [-n N_CONTROL] [-y YEARS]
                          [-o OUTPUT_DIR] [--seed SEED]
                          snapshot_file
create_lineages.py: error: the following arguments are required: snapshot_file

[2025-08-05 00:53:45] ERROR    | Rate 0.001000 failed: Lineage creation failed
[2025-08-05 00:53:45] INFO     | 
Processing rate 0.003000 (2/3)
[2025-08-05 00:56:10] ERROR    | Extracting year 50 snapshot failed: Traceback (most recent call last):
  File "/Users/alessandromassaad/jpi-methylation-simulation/step2/scripts/extract_snapshot.py", line 102, in <module>
    main()
  File "/Users/alessandromassaad/jpi-methylation-simulation/step2/scripts/extract_snapshot.py", line 96, in main
    success = extract_year_snapshot(input_file, year, output_file)
  File "/Users/alessandromassaad/jpi-methylation-simulation/step2/scripts/extract_snapshot.py", line 69, in extract_year_snapshot
    with gzip.open(output_file, 'wt') as f:
  File "/Users/alessandromassaad/opt/anaconda3/lib/python3.9/gzip.py", line 58, in open
    binary_file = GzipFile(filename, gz_mode, compresslevel)
  File "/Users/alessandromassaad/opt/anaconda3/lib/python3.9/gzip.py", line 173, in __init__
    fileobj = self.myfileobj = builtins.open(filename, mode or 'rb')
FileNotFoundError: [Errno 2] No such file or directory: '../data/rate_0.003000/snapshots/year50_snapshot.json.gz'

[2025-08-05 00:56:10] ERROR    |   ├── Failed to extract snapshot: Traceback (most recent call last):
  File "/Users/alessandromassaad/jpi-methylation-simulation/step2/scripts/extract_snapshot.py", line 102, in <module>
    main()
  File "/Users/alessandromassaad/jpi-methylation-simulation/step2/scripts/extract_snapshot.py", line 96, in main
    success = extract_year_snapshot(input_file, year, output_file)
  File "/Users/alessandromassaad/jpi-methylation-simulation/step2/scripts/extract_snapshot.py", line 69, in extract_year_snapshot
    with gzip.open(output_file, 'wt') as f:
  File "/Users/alessandromassaad/opt/anaconda3/lib/python3.9/gzip.py", line 58, in open
    binary_file = GzipFile(filename, gz_mode, compresslevel)
  File "/Users/alessandromassaad/opt/anaconda3/lib/python3.9/gzip.py", line 173, in __init__
    fileobj = self.myfileobj = builtins.open(filename, mode or 'rb')
FileNotFoundError: [Errno 2] No such file or directory: '../data/rate_0.003000/snapshots/year50_snapshot.json.gz'

[2025-08-05 00:56:10] ERROR    | Rate 0.003000 failed: Snapshot extraction failed
[2025-08-05 00:56:10] INFO     | 
Processing rate 0.005000 (3/3)
[2025-08-05 00:58:34] WARNING  | 
Batch processing interrupted by user!
