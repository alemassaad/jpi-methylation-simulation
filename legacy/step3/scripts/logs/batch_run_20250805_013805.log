[2025-08-05 01:38:05] INFO     | Logging initialized. Log file: logs/batch_run_20250805_013805.log
[2025-08-05 01:38:05] INFO     | ============================================================
[2025-08-05 01:38:05] INFO     | STEP 3 BATCH PROCESSING STARTED
[2025-08-05 01:38:05] INFO     | Start time: 2025-08-05 01:38:05
[2025-08-05 01:38:05] INFO     | ============================================================
[2025-08-05 01:38:05] INFO     | Phase 1: Discovery
[2025-08-05 01:38:05] INFO     |   ├── Found 2 completed Step 2 rates
[2025-08-05 01:38:05] INFO     |   ├── Rate 0.003000: Found simulation and lineages
[2025-08-05 01:38:05] INFO     |   ├── Rate 0.005000: Found simulation and lineages
[2025-08-05 01:38:05] INFO     | Selected 2 rates to process: ['0.003000', '0.005000']
[2025-08-05 01:38:05] INFO     | 
Phase 2: Validation
[2025-08-05 01:38:05] INFO     |   ├── Disk space: 24.8 GB available
[2025-08-05 01:38:05] INFO     | 
Phase 3: Processing
[2025-08-05 01:38:05] INFO     | 
Processing rate 0.003000 (1/2)
[2025-08-05 01:40:35] INFO     |   ├── Extracted year 60 snapshot OK (149.8s)
[2025-08-05 01:47:53] INFO     |   ├── Created individuals OK (438.1s)
[2025-08-05 01:47:55] WARNING  |   ├── Failed to create plots: /Users/alessandromassaad/opt/anaconda3/lib/python3.9/site-packages/numpy/core/fromnumeric.py:3474: RuntimeWarning:

Mean of empty slice.

/Users/alessandromassaad/opt/anaconda3/lib/python3.9/site-packages/numpy/core/_methods.py:189: RuntimeWarning:

invalid value encountered in double_scalars

/Users/alessandromassaad/opt/anaconda3/lib/python3.9/site-packages/numpy/core/_methods.py:264: RuntimeWarning:

Degrees of freedom <= 0 for slice

/Users/alessandromassaad/opt/anaconda3/lib/python3.9/site-packages/numpy/core/_methods.py:222: RuntimeWarning:

invalid value encountered in true_divide

/Users/alessandromassaad/opt/anaconda3/lib/python3.9/site-packages/numpy/core/_methods.py:256: RuntimeWarning:

invalid value encountered in double_scalars

Traceback (most recent call last):
  File "/Users/alessandromassaad/jpi-methylation-simulation/step3/scripts/plot_distributions.py", line 203, in <module>
    main()
  File "/Users/alessandromassaad/jpi-methylation-simulation/step3/scripts/plot_distributions.py", line 182, in main
    stats = save_statistics(mutant_jsds, control_jsds, stats_path)
  File "/Users/alessandromassaad/jpi-methylation-simulation/step3/scripts/plot_distributions.py", line 103, in save_statistics
    "min": float(np.min(mutant_jsds)),
  File "<__array_function__ internals>", line 180, in amin
  File "/Users/alessandromassaad/opt/anaconda3/lib/python3.9/site-packages/numpy/core/fromnumeric.py", line 2916, in amin
    return _wrapreduction(a, np.minimum, 'min', axis, None, out,
  File "/Users/alessandromassaad/opt/anaconda3/lib/python3.9/site-packages/numpy/core/fromnumeric.py", line 86, in _wrapreduction
    return ufunc.reduce(obj, axis, dtype, out, **passkwargs)
ValueError: zero-size array to reduction operation minimum which has no identity

[2025-08-05 01:47:55] INFO     | Rate 0.003000 completed successfully
[2025-08-05 01:47:55] INFO     | Progress: 1/2 | Processed: 1 | Failed: 0 | ETA: 01:57:44
[2025-08-05 01:47:55] INFO     | 
Processing rate 0.005000 (2/2)
[2025-08-05 01:50:31] INFO     |   ├── Extracted year 60 snapshot OK (155.8s)
[2025-08-05 01:50:31] ERROR    | Rate 0.005000 failed: Failed to create individuals: Traceback (most recent call last):
  File "/Users/alessandromassaad/jpi-methylation-simulation/step3/scripts/create_individuals.py", line 251, in <module>
    main()
  File "/Users/alessandromassaad/jpi-methylation-simulation/step3/scripts/create_individuals.py", line 217, in main
    snapshot_data = load_snapshot(args.year60_snapshot)
  File "/Users/alessandromassaad/jpi-methylation-simulation/step3/scripts/create_individuals.py", line 25, in load_snapshot
    with gzip.open(filepath, 'rt') as f:
  File "/Users/alessandromassaad/opt/anaconda3/lib/python3.9/gzip.py", line 58, in open
    binary_file = GzipFile(filename, gz_mode, compresslevel)
  File "/Users/alessandromassaad/opt/anaconda3/lib/python3.9/gzip.py", line 173, in __init__
    fileobj = self.myfileobj = builtins.open(filename, mode or 'rb')
FileNotFoundError: [Errno 2] No such file or directory: '../data/rate_0.005000/snapshots/year60_snapshot.json.gz'

[2025-08-05 01:50:31] INFO     | Progress: 2/2 | Processed: 1 | Failed: 1 | ETA: 01:50:31
[2025-08-05 01:50:31] INFO     | 
============================================================
[2025-08-05 01:50:31] INFO     | STEP 3 BATCH PROCESSING SUMMARY
[2025-08-05 01:50:31] INFO     | ============================================================
[2025-08-05 01:50:31] INFO     | Start time: 2025-08-05 01:38:05
[2025-08-05 01:50:31] INFO     | End time: 2025-08-05 01:50:31
[2025-08-05 01:50:31] INFO     | Duration: 0:12:25.333908
[2025-08-05 01:50:31] INFO     | 
Processed: 1
[2025-08-05 01:50:31] INFO     | Failed: 1
[2025-08-05 01:50:31] INFO     | Completed rates: ['0.003000']
[2025-08-05 01:50:31] INFO     | 
Failed rates: ['0.005000']
[2025-08-05 01:50:31] INFO     | 
Output directory: ../data
[2025-08-05 01:50:31] INFO     | 
Next steps:
[2025-08-05 01:50:31] INFO     | 1. Review individual rate results in each rate_* directory
[2025-08-05 01:50:31] INFO     | 2. Check combined_analysis/ for cross-rate comparisons
[2025-08-05 01:50:31] INFO     | 3. Examine statistical results in results/ subdirectories
